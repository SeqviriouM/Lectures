> Преподаватель: Мажаров Генадий Петрович

# Параллельные компьютерные системы

*КС* - компьютерные  системы

ИСпользование параллеьных КС заставляет их пользователей обращать внимание на новые проблемы: эффективно решать задачи на КС.

Красивых идей при построении параллельных КС очень много. Можно задаться вопрос почему параллельных архитектур так много? Как они и элементы взаимодействуют между собой? Какие основные факторы характеризуют каждую структуру? Поиск ответа на такие вопросы приводит к необходимости классификации архитектур КС.

### Классификация по структурно-функциональному признаку.

#### Классификация по Флинну

Наиболее ранняя классификация, предложенная в 1966г. Флинном. Классификация базируется на понятие *потока*, под которым понимается последовательность команд и данных, который обрабатывают процессы. На основе числа потоков команд и данных Флинн выделил 4 класса архитектуры:  
- **SISD(single instructions single data)** - одиночный поток команд и данных.
- **SIMD(single instructions multiple data)** - одиночный поток команд множественный поток данных. Включает векторные команды. Это позволяет ывполнять одну арифмитическую команду на множеством данных. которые служат элементами вектора.
- **MISD(multiple instructions single data)** - множественный поток команд и одиночный поток данных. Будем считать, что пока данных класс пуст
- **MIMD(multiple instructions multiple data)** - множественный поток команд и данных. Есть несколько устройств обработки команд, работающих каждая сос своим потоком данных

**Обозначение на рисунке**:  

- ПД - память данных
- УУ - устройство управления
- Пр - процессор

#### Классификация Хокни

Хокни разработал свой подход к классификации для более детальной систематизации КС, попадающих в класс Флинна.

1 -   
2 - каждый поток обрабатывается своим собственным конвеерным устройством  
3 - переключаемые  
4 - с общей памятью  
5 - с распределенной памятью  
6 - регулярные решетки  
7 - гиперкубы  
8 - иерархические структуры  
9 - изменяющиеся конфигурации   

**Основная идея** - множественный поток команд может быть обработан или одним конвеерным устройством, работающего в режиме разделения времени, либо каждый поток обрабатывается свои мсобственным устройством(конвеером). Первая возможность используется в MIMD компьютерах. Сюда можно отнести процессоры и машины Tera MTA. Архитектуры компьютеров, использующих вторую возможность делятся на 2 класса: в первый класс попадают компьтеры, где возможность связи каждого с каждым с помощью переключателей, во втором классе находятся компьютеры, где прямая связь процессора возможна только с ближайшеми соседями.

#### Классификация Фенг

Фенг предложил классифицировать КС по 2 характеристикам:
- числи n бит в машинном слове, обрабатываемых параллельно при выполении инструкции
- число m, обрабатываемых одновременно данной ВС. 

Немного изменив терминологию, функционирование ВС можно представить как параллельную обработку m битовых слоёв, на каждом из которых независимо преобразуются n бит. Каждую вычислительную систему можно описать парой чисел (n, m). Произведение P = n x m определяет интегральную характеристику
потенциала параллельности архитектуры, которую Фенг назвал максимальной степенью параллелизма ВС.

**Недостатки классификации**: связаны со способом вычисления ширины битового слоя m.

#### Классификация по Шнайдеру
В 1988 году Л.Шнайдер (L.Snyder) предложил новый подход к описанию архитектур параллельных вычислительных систем, попадающих в класс SIMD систематики Флинна.**Основная идея** заключается в выделении этапов выборки и непосредственно исполнения в потоках команд и данных. Именно разделение
потоков на адреса и их содержимое позволяет описать такие ранее "неудобные" для классификации архитектуры, как компьютеры с длинным командным словом, систолические массивы и целый ряд других.

#### Классификация по Хендлеру

В основу классификации В.Хендлер закладывает явное описание возможностей параллельной и конвейерной обработки информации вычислительной системой. При этом он намеренно не рассматривает различные способы связи между процессорами и блоками памяти и считает, что коммуникационная сеть может быть нужным образом сконфигурирована и будет способна выдержать предполагаемую нагрузку.
Предложенная классификация базируется на различии между тремя уровнями обработки данных в процессе выполнения программ:
- уровень выполнения программы - опираясь на счетчик команд и некоторые другие регистры, устройство управления (УУ) производит выборку и дешифрацию команд программы;
- уровень выполнения команд - арифметико-логическое устройство компьютера (АЛУ) исполняет команду, выданную ему устройством управления;
- уровень битовой обработки - все элементарные логические схемы процессора (ЭЛС) разбиваются нагруппы, необходимые для выполнения операций над одним двоичным разрядом.

Таким образом, подобная схема выделения уровней предполагает, что вычислительная система включает какое-то число процессоров каждый со своим устройством управления. Каждое устройство управления связано с несколькими арифметико-логическими устройствами, исполняющими одну и ту же
операцию в каждый конкретный момент времени. Наконец, каждое АЛУ объединяет несколько элементарных логических схем, ассоциированных с обработкой одного двоичного разряда (число ЭЛС есть ничто иное, как длина машинного слова).
Если на какое-то время не рассматривать возможность конвейеризации, то число устройств управления k , число арифметико-логических устройств d в каждом устройстве управления и число элементарных логических схем w в каждом АЛУ составят тройку для описания данной вычислительной системы C: t(C)= (k, d,
w)

#### Классификация Скилликорна

Классификация Скилликорна (1989) была очередным расширением классификации Флинна.

Архитектура любого компьютера в классификации Скилликорна рассматривается в виде комбинации четырёх абстрактных компонентов:
- процессоров команд (Instruction Processor — интерпретатор команд, может отсутствовать в системе)
- процессоров данных (Data Processor — преобразователь данных) - функциональное устройство, работающие как преобразаватель данных
- иерархии памяти (Instruction Memory, Data Memory — память программ и данных) - запоминающие устройство где хранятся данные и команды, пересылаемые между процессорами
- переключатель (связывающих процессоры и память)

Переключатели бывают четырёх типов — **«1-1»** (связывают пару устройств), **«n-n»** (связывает каждое устройство из одного множества устройств с соответствующим ему устройством из другого множества, то есть фиксирует попарную связь), **«n x n»** (связь любого устройства одного множества с любым устройством другого множества), **"1 - n"** (связывает одно устройство со множеством других устройств).

Систематизация Флинна, а также появивщиеся позже классификации не делают различий в организации распределенных вычислений. Общим свойством, обеспечивающих поведение производительности масштабируемых КС как раз и является распределенность высилений и данных. Это свойство характерно для симметричных процессоров. РАссмотренные принципы классификации КС не исчерпывают всех возможных характеристик КС.

### Классификация по функциональным возможностям. 

#### Общая характеристика и типы параллельных КС с точки зрения конечных пользователй.

Параллельные КС можно подразделить на:
- Мулькомпьютеры
- Кластеры
- Симметричные мультипроцессоры
- Архитектуры с распределенной памятью
- Массово-параллельные процессоры

Серьезное достижение в этой области есть у таких фирм как NEC, Hetachi, SGI.

#### Мультикомпьютеры  

Мультикомпьютеры – совокупность объединенных сетью отдельных вычислительных модулей, каждый из которых управляется своей ОС (например, серии SP1I6M). Узлы мультикомпьютеров обычно не имеют общих структур и связаны лишь сетью. Узлы обладают высокой степенью автономности и могут состоять из отдельных компонентов, в том числе и кластеров, SMP-, SPM-, DSM-, MPP–систем.

Для распределенной ОС мультикомпьютер выглядит как виртуальный однопроцессорный ресурс. Взаимодействие процессоров реализуется с помощью явно заданных операций связи между вычислителями. Обычно в мультикомпьютере реализуется согласованный сетевой протокол, и не существует единой очереди выполняющихся процессов, хотя известны и другие примеры. 

#### Кластер

**Кластер** – набор компонентов, рассматриваемый операционной системой, системным ПО, приложениями и пользователями как единая система.

Кластеры получили широкое распространение из-за высокого уровня производительности при относительно низких затратах. Высокая производительность объясняется отсутствием совместно используемой оперативной памяти и наличием в каждом узле копии общей ОС или собственной ОС для
неоднородных кластеров. Специализированное ПО производит контроль правильности работы узлов кластера. При отказе узла кластера его ресурсы (дисковое пространство, задание и т.д.) переназначаются другим узлам.

По сути, кластер образуется из отдельных полноценных узлов, включающих процессоры, память, подсистему ввода-вывода, ОС и т.д. При объединении компьютеров в кластер чаще всего поддерживается прямая связь между узлами посредством коммуникационной сети. Технология такой сети может варьироваться от простейшей (Ethernet) до сложных специализированных вариантов, обеспечивающих высокую скорость обмена. Возможно параллельное использование нескольких независимых сетей в рамках одного кластера. 

Рисунок 2. Типичные структуры кластеров: архитектура с разделяемыми дисками (слева) и архитектура без разделения дисков.

В архитектуре с разделением дисков все узлы кластера имеют доступ ко всем дискам. В архитектуре без разделения дисков, несмотря на то, что поддерживается целостный образ ресурса, каждый узел имеет собственную оперативную память и диски; в таких системах общей является только коммуникационная сеть.

С точки зрения повышения производительности кластер является хорошо масштабируемой ВС. Однако отсутствие общей разделяемой памяти (а иногда и единого адресного пространства) обуславливает большие накладные расходы, связанные с обменом сообщениями между узлами.

Наибольший эффект кластеры дают при вычислениях в рамках хорошо структурированных научных приложениях. С точки зрения удобства масштабирования кластерные архитектуры допускают практически неограниченное наращивание числа узлов. Для управления кластером используются специальные инструменты для поддержания единого образа ресурса, в частности, система пакетной обработки.

##### Симметричные мультипроцессоры(SMP)

Симметричный мультипроцессор (относится к классу процессоров-систем) состоит из нескольких десятков SMP, причем все процессоры разделяют общую память и объединены коммуникационной системой.

Существуют варианты SMP-архитектур с одной или несколькими системными шинами (например, Cray 6400 имел 4 системные шины). Также существуют SMP-архитектуры со специальными коммутаторами для связи процессоров, памяти и подсистемы ввода-вывода. Пропускная способность коммуникационной системы достаточна для поддержания быстрого доступа к памяти. У отдельных процессоров имеются свои
уровни кеш-памяти. Достаточный объем кеша и сравнительно небольшое количество процессоров позволяет удовлетворять обращения к основной памяти. Это легло в основу названия таких архитектур - UMA-архитектуры.

##### UMA(Uniform Memory Access, однородный доступ к памяти)

В UMA-архитектурах имеется единственная ОС, а ПО работает с единым адресным пространством. При этом возникает сложная проблема сохранения когерентности данных (согласованного извлечения содержимого кешей и основной памяти). Если модифицируется одна из копий данных, остальные копии должны либо также модифицироваться, било объявляться недостоверными. Отсюда – 2 альтернативных
подхода к поддержанию когерентности разделяемых данных:
- запись с обновлением данных
- запись с аннулированием данных

В SMP-системах обычно реализуется шинный протокол наблюдения. Происходит прослушивание шины всеми процессорами с целью обнаружения операций записи в те ячейки памяти, копии содержимого которых содержатся в кэше данного процессора. Производительность систем с общей памятью, в т.ч. SMP, зависит от
принятой модели согласованности памяти, определяющей, в каком порядке процессоры наблюдают последовательность операций записи-чтения.

Передача данных между кешами различных процессоров в SMP-системах выполняется значительно быстрее, чем обмен данными между узлами кластера или мультикомпьютера. Поэтому SMP-система хорошо масштабируется с ростом производительности при обработке большого числа коротких транзакций (например, банковские операции).

Сохранение когерентности требует специальных аппаратных средств быстрой модификации копий данных. Однако, если следовать строгой модели согласованности, когда каждая операция записи возвращает последнее записанное значение, то происходит неизбежное падение производительности. Главная сложность построения SMP-систем - сильная связанность процессоров и наличие единой ОС, разделяемой всеми процессорами.

##### DSM(системы с распределенной памятью)

DSM системы могут быть реализованы ращличными способами. Общим является в каждом процессорном узле: процессор, кеш, основная память. Узел может состоять из нескольких процессоров и иметь архитектуру SMP. В DSM поддреживается единая адресное пространство памяти, при этом память распределена по узлам. И время доступа зависит от места расположения данных. Поэтому некторые системы получили название **NUMA**(Non Uniform Memory Access(неоднородный доступ к памяти)). 


Из-за наличия проблем с масштабируемостью и SMP системы и UMA системы большей степенью ориентирован на большой рынок коммерческих приложений.

***Рисунок***

Одним из  узких мест, сдерживающих увеличение числа процессорных узлов является пропускная способность шин оперативной памяти. СТруктура сети позволяет процессорным узлам одновременно связаться друг с другом. Важная часть каждого узла: концентратор. По сути концентратор представляет собой коммутатор с 4 двунаправленными портами(шинами), которые связывает его с процессором, основной памятью, вводами.выводами и маршрутизаторами. Для когерентности используется протокол справочник. Применение программируемых маршрутизаторов позволяет реализовать системы с различной топологией. 

COMA - Cache Only Memory Architecture
 
 #### Массово-параллельные процессоры(MPP)
 В этих КС состоят из одного или нескольких процессоров локальной памяти и нескольких устройств ввода/вывода. Реализуется структураа без разделения ресурсов. В каждом узле работает своя копия ОС. 